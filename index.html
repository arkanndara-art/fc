<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆÛ•Ø±Ú¯ÛÚ•ÛŒ ÙÛ†Ù†Øª - Arkan Dara</title> 
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Sans+Arabic:wght@400;700&family=Lateef&family=Harmattan&family=Reem+Kufi&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; transition: 0.2s; }
        body { background: #f4f7f6; min-height: 100vh; display: flex; flex-direction: column; }
        body.dark-mode { background: #121212; color: #ffffff; }
        .header { background: white; padding: 10px 20px; border-bottom: 3px solid #2e7d32; display: grid; grid-template-columns: 140px 1.5fr auto 0.5fr auto; align-items: center; position: sticky; top: 0; z-index: 1000; gap: 15px; }
        .dark-mode .header { background: #1e1e1e; border-bottom-color: #4caf50; }
        .h-right { font-family: 'Amiri', serif; font-weight: bold; color: #2e7d32; font-size: 13px; white-space: nowrap; }
        .dark-mode .h-right { color: #4caf50; }
        .h-news { overflow: hidden; border-right: 1px solid #ddd; padding-right: 15px; }
        #news-link { text-decoration: none; color: #555; font-size: 13px; display: block; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; }
        .source-tag { color: #d32f2f; font-weight: bold; }
        .h-center h1 { font-family: 'Amiri', serif; font-size: 1.2rem; color: #2e7d32; margin: 0; }
        .h-left { display: flex; align-items: center; justify-content: flex-end; gap: 8px; }
        .stat-item { font-size: 11px; font-weight: bold; color: #555; background: #eee; padding: 5px 8px; border-radius: 6px; cursor: pointer; }
        .dark-mode .stat-item { background: #333; color: #ddd; }
        .container { flex: 1; display: flex; flex-direction: column; padding: 10px; gap: 5px; }
        textarea { flex: 1; min-height: 400px; padding: 20px; border-radius: 7px; border: 2px solid #ddd; font-size: 20px; text-align: right; direction: rtl; outline: none; }
        .dark-mode textarea { background: #1e1e1e; color: #eee; border-color: #333; }
        .btn-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 7px; }
        button, .btn-file { padding: 10px; border: none; cursor: pointer; font-weight: bold; border-radius: 8px; color: white; font-size: 14px; text-align: center; }
        .btn-uni { background: #4caf50; } .btn-ali { background: #2196f3; } .btn-copy { background: #607d8b; } .btn-clear { background: #f44336; } .btn-file { background: #333; }
        .market-drop { display: none; position: absolute; top: 35px; left: 0; background: white; min-width: 190px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; z-index: 100; }
        .show { display: block; }
        #status { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 8px 18px; border-radius: 50px; display: none; }
        .modal { display: none; position: fixed; z-index: 3000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 15% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 400px; text-align: center; }
        .dark-mode .modal-content { background: #1e1e1e; color: white; }
    </style>
</head>
<body onload="initApp()">

    <div id="aboutModal" class="modal"><div class="modal-content"><h3>Ø¯Û•Ø±Ø¨Ø§Ø±Û•ÛŒ Ù¾Ú•Û†Ú˜Û•</h3><p>Ú¯Û•Ø´Û•Ù¾ÛØ¯Û•Ø±: Ø¦Û•Ø±Ú©Ø§Ù† Ø¯Ø§Ø±Ø§</p><button onclick="toggleAbout()">Ø¯Ø§Ø®Ø³ØªÙ†</button></div></div>

    <div class="header">
        <div class="h-right" id="clock">Ù„Û†Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§Øª...</div>
        <div class="h-news"><a id="news-link" href="#" target="_blank">Ù„Û†Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù‡Û•ÙˆØ§ÚµÛ•Ú©Ø§Ù†...</a></div>
        <div class="h-center"><h1>ÙˆÛ•Ø±Ú¯ÛÚ•ÛŒ ÙÛ†Ù†Øª</h1><span>Arkan Dara</span></div>
        <div class="h-left">
            <select class="stat-item" id="fontSelect" onchange="changeFont()">
                <option value="'Noto Sans Arabic'">ÙÛ†Ù†ØªÛŒ Ù†Û†ØªÛ†</option>
                <option value="'Amiri'">ÙÛ†Ù†ØªÛŒ Ø¦Û•Ù…ÛŒØ±ÛŒ</option>
            </select>
            <div class="stat-item" onclick="toggleM()">ğŸ“Š Ø¨Û†Ø±Ø³Û•</div>
            <div id="mDrop" class="market-drop">
                <div id="gold">ğŸŸ¡ Ø²ÛÚ•: ...</div>
                <div id="oil-brent">ğŸ›¢ï¸ Ù†Û•ÙˆØª: ...</div>
            </div>
            <div class="stat-item" id="weather">ğŸŒ¡ï¸ --Â°C</div>
            <div class="stat-item" id="textStats">ÙˆØ´Û•: Ù </div>
            <div style="cursor:pointer;" onclick="toggleT()">ğŸŒ™</div>
            <div style="cursor:pointer;" onclick="toggleAbout()">â„¹ï¸</div>
        </div>
    </div>

    <div class="container">
        <textarea id="textBox" oninput="updateStats()" placeholder="Ø¯Û•Ù‚ Ù„ÛØ±Û• Ø¨Ù†ÙˆÙˆØ³Û•..."></textarea>
        <div class="btn-group">
            <button class="btn-uni" onclick="convert('toUni')">âœ¨ ÛŒÙˆÙ†ÛŒÚ©Û†Ø¯</button>
            <button class="btn-ali" onclick="convert('toAli')">ğŸ”„ Ø¹Û•Ù„ÛŒ Ú©Û•ÛŒ</button>
            <label for="fileInput" class="btn-file" style="cursor:pointer;">ğŸ“ ÙØ§ÛŒÙ„</label>
            <input type="file" id="fileInput" accept=".pdf,.docx,.txt" style="display:none;" onchange="handleFileUpload(event)">
            <button class="btn-copy" onclick="copyText()">ğŸ“‹ Ú©Û†Ù¾ÛŒ</button>
            <button class="btn-clear" onclick="clearText()">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</button>
        </div>
    </div>
    <div id="status"></div>

<script>
    // Ú©Û†Ø¯ÛŒ Ù‡Û•ÙˆØ§ÚµÛ•Ú©Ø§Ù†
    let newsList = []; let nIdx = 0;
    async function getNews() {
        const urls = [{n:'Ø±ÙˆÙˆØ¯Ø§Ùˆ', u:'https://www.rudaw.net/sorani/rss'},{n:'Ø§Ù„Ø¬Ø²ÛŒØ±Ø©', u:'https://www.aljazeera.net/rss'}];
        for(let s of urls) {
            try {
                const r = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(s.u)}`);
                const d = await r.json();
                d.items.forEach(i => newsList.push({t:i.title, l:i.link, s:s.n}));
            } catch(e){}
        }
        showNextNews();
    }
    function showNextNews() {
        if(!newsList.length) return;
        const el = document.getElementById('news-link');
        el.innerHTML = `<span class="source-tag">${newsList[nIdx].s}:</span> ${newsList[nIdx].t}`;
        el.href = newsList[nIdx].l;
        nIdx = (nIdx + 1) % newsList.length;
    }

    // Ú©Û†Ø¯ÛŒ Ú©Ø§Øª Ùˆ Ú•Û†Ú˜Û•Ú©Ø§Ù†ÛŒ Ù‡Û•ÙØªÛ•
    function updateClock() {
        const n = new Date();
        const days = ["ÛŒÛ•Ú©Ø´Û•Ù…Ù…Û•","Ø¯ÙˆÙˆØ´Û•Ù…Ù…Û•","Ø³ÛØ´Û•Ù…Ù…Û•","Ú†ÙˆØ§Ø±Ø´Û•Ù…Ù…Û•","Ù¾ÛÙ†Ø¬Ø´Û•Ù…Ù…Û•","Ù‡Û•ÛŒÙ†ÛŒ","Ø´Û•Ù…Ù…Û•"];
        document.getElementById('clock').innerText = `${days[n.getDay()]} ${n.toLocaleTimeString('en-GB',{hour12:false})}`;
    }

    // Ú©Û†Ø¯ÛŒ Ø®ÙˆÛÙ†Ø¯Ù†Û•ÙˆÛ•ÛŒ ÙØ§ÛŒÙ„
    async function handleFileUpload(event) {
        const file = event.target.files[0]; if(!file) return;
        const ext = file.name.split('.').pop().toLowerCase();
        showStatus("Ø®Û•Ø±ÛŒÚ©ÛŒ Ø®ÙˆÛÙ†Ø¯Ù†Û•ÙˆÛ•ÛŒ ÙØ§ÛŒÙ„...");
        if(ext === 'pdf') {
            const pdf = await pdfjsLib.getDocument(await file.arrayBuffer()).promise;
            let t = ""; for(let i=1;i<=pdf.numPages;i++) { const p = await pdf.getPage(i); const c = await p.getTextContent(); t += c.items.map(it => it.str).join(" "); }
            document.getElementById("textBox").value = t;
        } else if(ext === 'docx') {
            const res = await mammoth.extractRawText({arrayBuffer: await file.arrayBuffer()});
            document.getElementById("textBox").value = res.value;
        } else {
            const r = new FileReader(); r.onload = e => document.getElementById("textBox").value = e.target.result; r.readAsText(file);
        }
        showStatus("âœ… ÙØ§ÛŒÙ„Û•Ú©Û• Ù‡ÛÙ†Ø±Ø§"); updateStats();
    }

    // ÙˆÛ•Ø±Ú¯ÛÚ•Ø§Ù†
    const conversionMap = [{uni:'Úµ', ali:'Ù„Ù'}, {uni:'Ú•', ali:'Ø±Ù'}, {uni:'Ú˜', ali:'Ø°'}, {uni:'Û†', ali:'ÙˆÙ'}, {uni:'Ù¾', ali:'Ø«'}, {uni:'Ú†', ali:'Ø¶'}, {uni:'Ú¯', ali:'Ø·'}, {uni:'Ú¤', ali:'Ø¸'}, {uni:'Û', ali:'ÙŠÙ'}, {uni:'Û•', ali:'Ø©'}];
    function convert(type) {
        let b = document.getElementById("textBox"); let t = b.value;
        conversionMap.forEach(i => t = t.replace(new RegExp(type==='toUni'?i.ali:i.uni,'g'), type==='toUni'?i.uni:i.ali));
        b.value = t; showStatus("âœ… Ú¯Û†Ú•Ø¯Ø±Ø§");
    }

    // Ø¨Û†Ø±Ø³Û• Ùˆ Ú©Û•Ø´ÙˆÙ‡Û•ÙˆØ§
    async function updateMarket() {
        try {
            const r = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=PAXGUSDT');
            const d = await r.json(); document.getElementById('gold').innerText = `ğŸŸ¡ Ø²ÛÚ•: $${parseFloat(d.price).toFixed(0)}`;
        } catch(e){}
    }

    function initApp() {
        setInterval(updateClock, 1000);
        getNews(); setInterval(showNextNews, 7000);
        updateMarket(); updateClock();
    }
    function toggleAbout() { const m = document.getElementById("aboutModal"); m.style.display = (m.style.display==="block")?"none":"block"; }
    function toggleM() { document.getElementById("mDrop").classList.toggle("show"); }
    function toggleT() { document.body.classList.toggle('dark-mode'); }
    function copyText() { navigator.clipboard.writeText(document.getElementById("textBox").value); showStatus("ğŸ“‹ Ú©Û†Ù¾ÛŒ Ú©Ø±Ø§"); }
    function clearText() { if(confirm("Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ØŸ")) document.getElementById("textBox").value=""; }
    function updateStats() { const t = document.getElementById('textBox').value.trim(); document.getElementById('textStats').innerText = `ÙˆØ´Û•: ${t?t.split(/\s+/).length:0}`; }
    function changeFont() { document.getElementById('textBox').style.fontFamily = document.getElementById('fontSelect').value; }
    function showStatus(m) { const s = document.getElementById("status"); s.innerText=m; s.style.display="block"; setTimeout(()=>s.style.display="none",2000); }
</script>
</body>
</html>
